<!DOCTYPE html>
<html><head title="Doc"><meta charset="UTF-8"/><link href="styles.css" rel="stylesheet"/></head><body><nav class="sidebar"><h3>Modules</h3><ul><li><li><a href="CanDB.html">CanDB</a></li></li><li><li><a href="CanDBAdmin.html">CanDBAdmin</a></li></li><li><li><a href="CanisterActions.html">CanisterActions</a></li></li><li><li><a href="CanisterMap.html">CanisterMap</a></li></li><li><li><a href="Entity.html">Entity</a></li></li><li><li><a href="HashTree.html">HashTree</a></li></li><li><li><a href="InterfaceSpec.html">InterfaceSpec</a></li></li><li><li><a href="RangeTree.html">RangeTree</a></li></li><li><li><a href="SingleCanisterCanDB.html">SingleCanisterCanDB</a></li></li></ul><h3>Declarations</h3><ul><li><li><a href="#type.HashTree">HashTree</a></li></li><li><li><a href="#init">init</a></li></li><li><li><a href="#initPreSized">initPreSized</a></li></li><li><li><a href="#get">get</a></li></li><li><li><a href="#put">put</a></li></li><li><li><a href="#replace">replace</a></li></li><li><li><a href="#update">update</a></li></li><li><li><a href="#delete">delete</a></li></li><li><li><a href="#remove">remove</a></li></li><li><li><a href="#scan">scan</a></li></li><li><li><a href="#scanLimit">scanLimit</a></li></li><li><li><a href="#scanLimitReverse">scanLimitReverse</a></li></li><li><li><a href="#equal">equal</a></li></li></ul></nav><div class="documentation"><h1>HashTree</h1><p>&quot;HashTree&quot; (single canister CanDB only) - the data structure underlying SingleCanisterCanDB. A HashTree is a stable HashMap, which contains a HashTable storing a mapping of an Primary Key to RangeTree,
where the RangeTree contains a mapping of an Entity's Sort Key to its Attributes</p>
<div class="declaration"><h4 class="type-declaration" id="type.HashTree"><span class="keyword">type </span><span class="type">HashTree</span> = <span class="type">HM.StableHashMap</span>&lt;<a href="Entity.html#type.PK"><span class="type">E.PK</span></a>, <a href="RangeTree.html#type.RangeTree"><span class="type">RT.RangeTree</span></a>&gt;</h4><p><p>A HashTree is a HashMap with keys being each Entity's Primary Key and Values being RangeTrees containing the Sort Key and Attributes of that particular Entity</p>
</p></div><div class="declaration"><h4 class="function" id="init"><code><span class="keyword">public func </span><span class="fnname">init</span>() : <a href="#type.HashTree"><span class="type">HashTree</span></a></code></h4><p><p>Initializes a StableHashTree with initCapacity and table size zero</p>
</p></div><div class="declaration"><h4 class="function" id="initPreSized"><code><span class="keyword">public func </span><span class="fnname">initPreSized</span>(<span class="parameter">initCapacity</span> : <span class="type">Nat</span>) : <a href="#type.HashTree"><span class="type">HashTree</span></a></code></h4><p></p></div><div class="declaration"><h4 class="function" id="get"><code><span class="keyword">public func </span><span class="fnname">get</span>(<br/>  <span class="parameter">ht</span> : <a href="#type.HashTree"><span class="type">HashTree</span></a>, <br/>  <span class="parameter">pk</span> : <a href="Entity.html#type.PK"><span class="type">E.PK</span></a>, <br/>  <span class="parameter">sk</span> : <a href="Entity.html#type.SK"><span class="type">E.SK</span></a><br/>) : ?<a href="Entity.html#type.Entity"><span class="type">E.Entity</span></a></code></h4><p><p>Gets an entity from the HashTree by pk + sk if that entity exists</p>
</p></div><div class="declaration"><h4 class="function" id="put"><code><span class="keyword">public func </span><span class="fnname">put</span>(<span class="parameter">ht</span> : <a href="#type.HashTree"><span class="type">HashTree</span></a>, <span class="parameter">entity</span> : <a href="Entity.html#type.Entity"><span class="type">E.Entity</span></a>) : ()</code></h4><p><p>Insert/Replace an entity into the HashTree and returns nothing
Mutates the underlying HashTree passed to this function</p>
</p></div><div class="declaration"><h4 class="function" id="replace"><code><span class="keyword">public func </span><span class="fnname">replace</span>(<span class="parameter">ht</span> : <a href="#type.HashTree"><span class="type">HashTree</span></a>, <span class="parameter">entity</span> : <a href="Entity.html#type.Entity"><span class="type">E.Entity</span></a>) : ?<a href="Entity.html#type.Entity"><span class="type">E.Entity</span></a></code></h4><p><p>Insert/Replace an entity into the HashTree and returns the previous value stored at
the pk + sk if existed.
Mutates the underlying HashTree passed to this function</p>
</p></div><div class="declaration"><h4 class="function" id="update"><code><span class="keyword">public func </span><span class="fnname">update</span>(<br/>  <span class="parameter">ht</span> : <a href="#type.HashTree"><span class="type">HashTree</span></a>, <br/>  <span class="parameter">pk</span> : <a href="Entity.html#type.PK"><span class="type">E.PK</span></a>, <br/>  <span class="parameter">sk</span> : <a href="Entity.html#type.SK"><span class="type">E.SK</span></a>, <br/>  <span class="parameter">updateFunction</span> : (?<a href="Entity.html#type.AttributeMap"><span class="type">E.AttributeMap</span></a>) -&gt; <a href="Entity.html#type.AttributeMap"><span class="type">E.AttributeMap</span></a><br/>) : ?<a href="Entity.html#type.Entity"><span class="type">E.Entity</span></a></code></h4><p><p>Creates or updates an entry in the HashTree based upon if the pk + sk of the entity provided exists.</p>
<p>Applies a function that takes null if the entity's pk + sk does not exist, or the current AttributeMap of an existing entity and returns 
a new AttributeMap that is used to update the attributes of the entity</p>
</p></div><div class="declaration"><h4 class="function" id="delete"><code><span class="keyword">public func </span><span class="fnname">delete</span>(<br/>  <span class="parameter">ht</span> : <a href="#type.HashTree"><span class="type">HashTree</span></a>, <br/>  <span class="parameter">pk</span> : <a href="Entity.html#type.PK"><span class="type">E.PK</span></a>, <br/>  <span class="parameter">sk</span> : <a href="Entity.html#type.SK"><span class="type">E.SK</span></a><br/>) : ()</code></h4><p><p>Deletes an entity from the HashTree by pk/sk if that entity exists. Does not return any value
Mutates the underlying HashTree passed to this function</p>
</p></div><div class="declaration"><h4 class="function" id="remove"><code><span class="keyword">public func </span><span class="fnname">remove</span>(<br/>  <span class="parameter">ht</span> : <a href="#type.HashTree"><span class="type">HashTree</span></a>, <br/>  <span class="parameter">pk</span> : <a href="Entity.html#type.PK"><span class="type">E.PK</span></a>, <br/>  <span class="parameter">sk</span> : <a href="Entity.html#type.SK"><span class="type">E.SK</span></a><br/>) : ?<a href="Entity.html#type.Entity"><span class="type">E.Entity</span></a></code></h4><p><p>Deletes an entity from the HashTree by pk/sk if that entity exists, and returns the original value if that entity exists
Mutates the underlying HashTree passed to this function</p>
</p></div><div class="declaration"><h4 class="function" id="scan"><code><span class="keyword">public func </span><span class="fnname">scan</span>(<br/>  <span class="parameter">ht</span> : <a href="#type.HashTree"><span class="type">HashTree</span></a>, <br/>  <span class="parameter">pk</span> : <a href="Entity.html#type.PK"><span class="type">E.PK</span></a>, <br/>  <span class="parameter">skLowerBound</span> : <a href="Entity.html#type.SK"><span class="type">E.SK</span></a>, <br/>  <span class="parameter">skUpperBound</span> : <a href="Entity.html#type.SK"><span class="type">E.SK</span></a><br/>) : [<a href="Entity.html#type.Entity"><span class="type">E.Entity</span></a>]</code></h4><p><p>Returns a range of entities that exactly match the provided pk, and are in between the sk lower and upper bounds (inclusive)</p>
</p></div><div class="declaration"><h4 class="function" id="scanLimit"><code><span class="keyword">public func </span><span class="fnname">scanLimit</span>(<br/>  <span class="parameter">ht</span> : <a href="#type.HashTree"><span class="type">HashTree</span></a>, <br/>  <span class="parameter">pk</span> : <a href="Entity.html#type.PK"><span class="type">E.PK</span></a>, <br/>  <span class="parameter">skLowerBound</span> : <a href="Entity.html#type.SK"><span class="type">E.SK</span></a>, <br/>  <span class="parameter">skUpperBound</span> : <a href="Entity.html#type.SK"><span class="type">E.SK</span></a>, <br/>  <span class="parameter">limit</span> : <span class="type">Nat</span><br/>) : ([<a href="Entity.html#type.Entity"><span class="type">E.Entity</span></a>], ?<a href="Entity.html#type.SK"><span class="type">E.SK</span></a>)</code></h4><p><p>Returns a limit specified range of entities in ascending order that exactly match the provided pk, and are in between the sk lower and upper bounds (inclusive)</p>
</p></div><div class="declaration"><h4 class="function" id="scanLimitReverse"><code><span class="keyword">public func </span><span class="fnname">scanLimitReverse</span>(<br/>  <span class="parameter">ht</span> : <a href="#type.HashTree"><span class="type">HashTree</span></a>, <br/>  <span class="parameter">pk</span> : <a href="Entity.html#type.PK"><span class="type">E.PK</span></a>, <br/>  <span class="parameter">skLowerBound</span> : <a href="Entity.html#type.SK"><span class="type">E.SK</span></a>, <br/>  <span class="parameter">skUpperBound</span> : <a href="Entity.html#type.SK"><span class="type">E.SK</span></a>, <br/>  <span class="parameter">limit</span> : <span class="type">Nat</span><br/>) : ([<a href="Entity.html#type.Entity"><span class="type">E.Entity</span></a>], ?<a href="Entity.html#type.SK"><span class="type">E.SK</span></a>)</code></h4><p><p>Returns a limit specified range of entities in descending order that exactly match the provided pk, and are in between the sk lower and upper bounds (inclusive)</p>
</p></div><div class="declaration"><h4 class="function" id="equal"><code><span class="keyword">public func </span><span class="fnname">equal</span>(<span class="parameter">ht1</span> : <a href="#type.HashTree"><span class="type">HashTree</span></a>, <span class="parameter">ht2</span> : <a href="#type.HashTree"><span class="type">HashTree</span></a>) : <span class="type">Bool</span></code></h4><p><p>Return a boolean indicating if the two HashTrees are equivalent, ignoring deleted entries in the underlying RangeTree Red-Black Tree</p>
</p></div></div></body></html>