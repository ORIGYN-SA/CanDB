<!DOCTYPE html>
<html><head title="Doc"><meta charset="UTF-8"/><link href="styles.css" rel="stylesheet"/></head><body><nav class="sidebar"><h3>Modules</h3><ul><li><li><a href="CanDB.html">CanDB</a></li></li><li><li><a href="CanDBAdmin.html">CanDBAdmin</a></li></li><li><li><a href="CanisterActions.html">CanisterActions</a></li></li><li><li><a href="CanisterMap.html">CanisterMap</a></li></li><li><li><a href="Entity.html">Entity</a></li></li><li><li><a href="HashTree.html">HashTree</a></li></li><li><li><a href="InterfaceSpec.html">InterfaceSpec</a></li></li><li><li><a href="RangeTree.html">RangeTree</a></li></li><li><li><a href="SingleCanisterCanDB.html">SingleCanisterCanDB</a></li></li><li><li><a href="Utils.html">Utils</a></li></li></ul><h3>Declarations</h3><ul><li><li><a href="#type.RangeTree">RangeTree</a></li></li><li><li><a href="#init">init</a></li></li><li><li><a href="#get">get</a></li></li><li><li><a href="#put">put</a></li></li><li><li><a href="#replace">replace</a></li></li><li><li><a href="#update">update</a></li></li><li><li><a href="#delete">delete</a></li></li><li><li><a href="#remove">remove</a></li></li><li><li><a href="#scanLimit">scanLimit</a></li></li><li><li><a href="#scanLimitReverse">scanLimitReverse</a></li></li><li><li><a href="#scan">scan</a></li></li><li><li><a href="#entries">entries</a></li></li><li><li><a href="#equal">equal</a></li></li><li><li><a href="#toText">toText</a></li></li></ul></nav><div class="documentation"><h1>RangeTree</h1><p>&quot;RangeTree&quot; - a stable Red-Black Tree for storing the relationship between an Entity's Sort Key and its Attributes</p>
<div class="declaration"><h4 class="type-declaration" id="type.RangeTree"><span class="keyword">type </span><span class="type">RangeTree</span> = <span class="type">RBT.Tree</span>&lt;<a href="Entity.html#type.SK"><span class="type">E.SK</span></a>, <a href="Entity.html#type.AttributeMap"><span class="type">E.AttributeMap</span></a>&gt;</h4><p><p>A RangeTree data structure is a Red-Black Tree mapping of a Sort Key (Text) to an AttributeMap</p>
</p></div><div class="declaration"><h4 class="function" id="init"><code><span class="keyword">public func </span><span class="fnname">init</span>() : <a href="#type.RangeTree"><span class="type">RangeTree</span></a></code></h4><p><p>Initializes an empty RangeTree</p>
</p></div><div class="declaration"><h4 class="function" id="get"><code><span class="keyword">public func </span><span class="fnname">get</span>(<span class="parameter">rt</span> : <a href="#type.RangeTree"><span class="type">RangeTree</span></a>, <span class="parameter">sk</span> : <a href="Entity.html#type.SK"><span class="type">E.SK</span></a>) : ?<a href="Entity.html#type.AttributeMap"><span class="type">E.AttributeMap</span></a></code></h4><p><p>Returns an entry from the RangeTree based on the sk provided that sk exists in the RangeTree with a non-null AttributeMap</p>
</p></div><div class="declaration"><h4 class="function" id="put"><code><span class="keyword">public func </span><span class="fnname">put</span>(<span class="parameter">rt</span> : <a href="#type.RangeTree"><span class="type">RangeTree</span></a>, <span class="parameter">entity</span> : <a href="Entity.html#type.Entity"><span class="type">E.Entity</span></a>) : <a href="#type.RangeTree"><span class="type">RangeTree</span></a></code></h4><p><p>Creates or replaces an entry in the RangeTree based upon if the sk of the entity provided exists. Returns the new RangeTree</p>
</p></div><div class="declaration"><h4 class="function" id="replace"><code><span class="keyword">public func </span><span class="fnname">replace</span>(<span class="parameter">rt</span> : <a href="#type.RangeTree"><span class="type">RangeTree</span></a>, <span class="parameter">entity</span> : <a href="Entity.html#type.Entity"><span class="type">E.Entity</span></a>) : (?<a href="Entity.html#type.AttributeMap"><span class="type">E.AttributeMap</span></a>, <a href="#type.RangeTree"><span class="type">RangeTree</span></a>)</code></h4><p><p>Creates or replaces an entry in the RangeTree based upon if the sk of the entity provided exists. Returns the old AttributeMap if the sk existed and the new RangeTree</p>
</p></div><div class="declaration"><h4 class="function" id="update"><code><span class="keyword">public func </span><span class="fnname">update</span>(<br/>  <span class="parameter">rt</span> : <a href="#type.RangeTree"><span class="type">RangeTree</span></a>, <br/>  <span class="parameter">sk</span> : <a href="Entity.html#type.SK"><span class="type">E.SK</span></a>, <br/>  <span class="parameter">updateFunction</span> : (?<a href="Entity.html#type.AttributeMap"><span class="type">E.AttributeMap</span></a>) -&gt; <a href="Entity.html#type.AttributeMap"><span class="type">E.AttributeMap</span></a><br/>) : (?<a href="Entity.html#type.AttributeMap"><span class="type">E.AttributeMap</span></a>, <a href="#type.RangeTree"><span class="type">RangeTree</span></a>)</code></h4><p><p>Creates or updates an entry in the RangeTree based upon if the sk of the entity provided exists.</p>
<p>The updateFunction parameter applies a function that takes null if the entry does not exist, or the current AttributeMap of an existing entry and returns 
a new AttributeMap that is used to update the attributeMap entry.</p>
</p></div><div class="declaration"><h4 class="function" id="delete"><code><span class="keyword">public func </span><span class="fnname">delete</span>(<span class="parameter">rt</span> : <a href="#type.RangeTree"><span class="type">RangeTree</span></a>, <span class="parameter">sk</span> : <a href="Entity.html#type.SK"><span class="type">E.SK</span></a>) : <a href="#type.RangeTree"><span class="type">RangeTree</span></a></code></h4><p><p>Deletes an entry from the RangeTree based upon if the sk of the entity provided exists. Returns the new RangeTree</p>
</p></div><div class="declaration"><h4 class="function" id="remove"><code><span class="keyword">public func </span><span class="fnname">remove</span>(<span class="parameter">rt</span> : <a href="#type.RangeTree"><span class="type">RangeTree</span></a>, <span class="parameter">sk</span> : <a href="Entity.html#type.SK"><span class="type">E.SK</span></a>) : (?<a href="Entity.html#type.AttributeMap"><span class="type">E.AttributeMap</span></a>, <a href="#type.RangeTree"><span class="type">RangeTree</span></a>)</code></h4><p><p>Deletes an entry from the RangeTree based upon if the sk of the entity provided exists. Returns the deleted AttributeMap if the sk existed and the new RangeTree</p>
</p></div><div class="declaration"><h4 class="function" id="scanLimit"><code><span class="keyword">public func </span><span class="fnname">scanLimit</span>(<br/>  <span class="parameter">rt</span> : <a href="#type.RangeTree"><span class="type">RangeTree</span></a>, <br/>  <span class="parameter">skLowerBound</span> : <a href="Entity.html#type.SK"><span class="type">E.SK</span></a>, <br/>  <span class="parameter">skUpperBound</span> : <a href="Entity.html#type.SK"><span class="type">E.SK</span></a>, <br/>  <span class="parameter">limit</span> : <span class="type">Nat</span><br/>) : ([(<a href="Entity.html#type.SK"><span class="type">E.SK</span></a>, <a href="Entity.html#type.AttributeMap"><span class="type">E.AttributeMap</span></a>)], ?<a href="Entity.html#type.SK"><span class="type">E.SK</span></a>)</code></h4><p><p>Performs a in-order scan of the RangeTree between the provided SortKey bounds, returning a number of matching entries in ascending order limited by the limit parameter specified in an array formatted as (SK, AttributeMap) for each entry</p>
</p></div><div class="declaration"><h4 class="function" id="scanLimitReverse"><code><span class="keyword">public func </span><span class="fnname">scanLimitReverse</span>(<br/>  <span class="parameter">rt</span> : <a href="#type.RangeTree"><span class="type">RangeTree</span></a>, <br/>  <span class="parameter">skLowerBound</span> : <a href="Entity.html#type.SK"><span class="type">E.SK</span></a>, <br/>  <span class="parameter">skUpperBound</span> : <a href="Entity.html#type.SK"><span class="type">E.SK</span></a>, <br/>  <span class="parameter">limit</span> : <span class="type">Nat</span><br/>) : ([(<a href="Entity.html#type.SK"><span class="type">E.SK</span></a>, <a href="Entity.html#type.AttributeMap"><span class="type">E.AttributeMap</span></a>)], ?<a href="Entity.html#type.SK"><span class="type">E.SK</span></a>)</code></h4><p><p>Performs a reverse-order scan of the RangeTree between the provided SortKey bounds, returning a number of matching entries in descending order limited by the limit parameter specified in an array formatted as (SK, AttributeMap) for each entry</p>
</p></div><div class="declaration"><h4 class="function" id="scan"><code><span class="keyword">public func </span><span class="fnname">scan</span>(<br/>  <span class="parameter">rt</span> : <a href="#type.RangeTree"><span class="type">RangeTree</span></a>, <br/>  <span class="parameter">skLowerBound</span> : <a href="Entity.html#type.SK"><span class="type">E.SK</span></a>, <br/>  <span class="parameter">skUpperBound</span> : <a href="Entity.html#type.SK"><span class="type">E.SK</span></a><br/>) : [(<a href="Entity.html#type.SK"><span class="type">E.SK</span></a>, <a href="Entity.html#type.AttributeMap"><span class="type">E.AttributeMap</span></a>)]</code></h4><p><p>Not recommended that this is used because it's then more likely that a developer will run into the 2MB egress limit. A limit should
therefore be enforced
Performs a full scan of the RangeTree between the provided Sort Key bounds, returning an array of the matching (SK, AttributeMap) for each entry</p>
</p></div><div class="declaration"><h4 class="function" id="entries"><code><span class="keyword">public func </span><span class="fnname">entries</span>(<span class="parameter">rt</span> : <a href="#type.RangeTree"><span class="type">RangeTree</span></a>) : <span class="type">I.Iter</span>&lt;(<a href="Entity.html#type.SK"><span class="type">E.SK</span></a>, <a href="Entity.html#type.AttributeMap"><span class="type">E.AttributeMap</span></a>)&gt;</code></h4><p><p>Returns an iterator of all entries in the RangeTree</p>
</p></div><div class="declaration"><h4 class="function" id="equal"><code><span class="keyword">public func </span><span class="fnname">equal</span>(<span class="parameter">rt1</span> : <a href="#type.RangeTree"><span class="type">RangeTree</span></a>, <span class="parameter">rt2</span> : <a href="#type.RangeTree"><span class="type">RangeTree</span></a>) : <span class="type">Bool</span></code></h4><p><p>Performs an equality check between two RangeTrees</p>
</p></div><div class="declaration"><h4 class="function" id="toText"><code><span class="keyword">public func </span><span class="fnname">toText</span>(<span class="parameter">rt</span> : <a href="#type.RangeTree"><span class="type">RangeTree</span></a>) : <span class="type">Text.Text</span></code></h4><p><p>Mostly for testing/debugging purposes, generates a textual representation of the RangeTree</p>
</p></div></div></body></html>